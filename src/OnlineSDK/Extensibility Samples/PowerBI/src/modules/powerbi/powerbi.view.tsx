/*!
 * Copyright (c) Microsoft Corporation.
 * All rights reserved. See LICENSE in the project root for license information.
 */

import * as React from 'react';
import { Heading } from '@msdyn365-commerce-modules/utilities';
import PowerBiReportsListComponent from './components/powerbi-reportsList.component';
import PowerBiAuthComponent from './components/powerbi-auth.component';
import { IPowerbiData } from './powerbi.data';
import { IPowerbiProps, reportView } from './powerbi.props.autogenerated';
import PowerBiAnonymousComponent from './components/powerbi-anonymous.component';

const PowerbiView = (props: IPowerbiProps<IPowerbiData>): JSX.Element => {
    const { reportHeading } = props.config;
    const reportScope: string[] = ['https://analysis.windows.net/powerbi/api/Report.Read.All'];

    const reportHeadingText = reportHeading ? (
        <Heading className='ms-power-bi__heading' headingTag={reportHeading.tag} text={reportHeading.text} />
    ) : null;

    return (
        <>
            {reportHeadingText}
            {props.config.enableAuthFlow ? (
                <PowerBiAuthComponent
                    scope={reportScope}
                    clientId={props.config.clientId ? props.config.clientId : ''}
                    workspaceId={props.config.workspaceId ? props.config.workspaceId : ''}
                    reportId={props.config.reportId ? props.config.reportId : ''}
                />
            ) : props.config.reportView === reportView.single ? (
                <PowerBiAnonymousComponent props={props} />
            ) : (
                <div className='msc-power-bi-report-list'>
                    <PowerBiReportsListComponent props={props} />
                </div>
            )}
        </>
    );
};
export default PowerbiView;
